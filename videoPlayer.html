<!DOCTYPE html>
<html>
<link rel="stylesheet" href="https://cdn.plyr.io/2.0.11/plyr.css">
<link rel="stylesheet" href="https://cdn.plyr.io/2.0.11/demo.css">
<script src="https://cdn.plyr.io/2.0.11/plyr.js"></script>

<!-- google analytics -->    
<script src="fireheap.js"></script>        
<script src="assets/js/googleanalytics.js"></script>


<body></body>

<script>
// sample test
// http://localhost:8080/plyr_referrer.html?type=youtube&id=bTqVqk7FSmY

var player = null;

window.onload = function(){

	// get video data from query string
	var type = getParameter('type');
	var id   = getParameter('id');	

	// create div for video
	var div = document.createElement('div');
	div.setAttribute('data-type', type);
	div.setAttribute('data-video-id', id);
	div.setAttribute('id', 'placeholder');	

	// add to div to document
	document.body.appendChild(div);	

	// instantiate player
	player = plyr.setup(div[0], {
		autoplay: true
	});

	// log events
	log();
};


function getParameter(name) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
}

function log(){

	var events = [
		'ready',
		'canplay',
		'canplaythrough',
		'emptied',
		'ended',
		'error',
		'loadeddata',
		'loadedmetadata',
		'loadstart',
		'pause',
		'play',
		'playing',
		'progress',
		'seeked',
		'seeking',
		'stalled',
		'timeupdate',
		'volumechange',
		'waiting',
		'enterfullscreen',
		'exitfullscreen',
		'captionsenabled',
		'captionsdisabled',
		'destroyed'
	];

	events.forEach(function(event){
		player[0].on(event, function(e) {
			console.log(event);					
			console.log(e.timeStamp);
			console.log(e.detail.plyr.getCurrentTime());
			console.log(e.detail.plyr.getDuration());
			console.log(e.detail.plyr.getVolume());
			console.log(e.detail.plyr.isMuted());			
		});	
	});
}


</script>

</html>